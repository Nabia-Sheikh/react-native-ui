import { FlatList, StyleSheet, View } from "react-native";
import React from "react";

import listingsAPI from "../api/listing";

import Card from "../components/Card";
import routes from "../navigation/routes";
import AppText from "../components/AppText";
import AppButton from "../components/AppButton";
import ActivityIndicator from "../components/ActivityIndicator";
import useApi from "../hooks/useApi";

const ListingScreen = ({ navigation }) => {
  const {
    data: listings,
    error,
    isLoading: loading,
    request: loadListings,
  } = useApi(listingsAPI.getListings);

  React.useEffect(() => {
    loadListings();
    console.log(listings);
  }, []);

  return (
    <>
      {error && (
        <>
          <AppText>Couldn't retrive the listings</AppText>
          <AppButton text='Retry' onPress={loadListings} />
        </>
      )}

      {loading && <ActivityIndicator visible={true} />}

      <FlatList
        data={listings}
        keyExtractor={(listing) => listing._id.toString()}
        renderItem={({ item }) => (
          <Card
            title={item.name}
            price={item.price}
            imageURL={
              "data:image/jpeg;base64,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"
            }
            onPress={() => navigation.navigate(routes.LISTING_DETAILS, item)}
          />
        )}
      />
    </>
  );
};

export default ListingScreen;

const styles = StyleSheet.create({});
